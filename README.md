# 基于OKX和Uniswap的套利机器人
这个基于Python的项目是一个套利机器人，旨在识别并利用OKX加密货币交易所和Uniswap去中心化交易所（DEX）之间ETH-USDT交易对的价格差异获利。

## 关键特性
1. **价格监控**：持续监控OKX和Uniswap上ETH-USDT的价格。它通过WebSocket获取OKX的价格，并利用Uniswap池合约中的链上数据计算Uniswap的价格。
2. **套利机会检测**：检查两个平台之间的价格差异。当价格差异超过预先设定的最小利润阈值（默认5个基点）时，表明存在潜在的套利机会。同时设置了熔断机制，如果价格差异在不利方向过大（小于 - 50个基点），机器人将停止运行以防止过度损失。
3. **余额和交易检查**：验证钱包中ETH和USDT的可用余额。在尝试套利交易之前，确保有足够的资金进行操作。它还会检查以太坊网络的当前Gas价格，如果Gas价格过高（高于100 Gwei），机器人将不会执行交易。


## 工作原理
1. **初始化**：机器人通过加载必要的环境变量（如Infura URL、Uniswap池地址、钱包地址和私钥，不过在模拟交易模式下私钥不用于实际交易）进行初始化。它还配置日志记录以记录重要事件和错误。
2. **价格获取**：`get_okx_price`方法连接到OKX的WebSocket并订阅ETH-USDT-SWAP的行情数据。`get_uniswap_price`方法与Uniswap池合约交互以获取相关数据并计算价格。
3. **套利检查**：`check_arbitrage_2`方法比较OKX和Uniswap的价格。如果检测到套利机会，它会调用`execute_trade`方法。
4. **监控循环**：`monitor`方法运行一个无限循环，定期（每3秒）检查价格变化和套利机会。如果在过程中出现任何错误，它会记录错误并等待8秒后重试。

## 前提条件
1. 系统上安装了Python 3.x。
2. 安装所需的Python库：`web3`、`python-dotenv`、`websocket-client`，可以使用`pip`进行安装。
3. 一个有效的Infura URL，用于与以太坊网络进行交互。
4. Uniswap池合约的ABI（应用二进制接口），保存为项目目录中的`uniswap_pool_abi.json`文件。

## 使用方法
1. 将仓库克隆到本地机器。
2. 在项目目录中创建一个`.env`文件，并填写所需的环境变量。
3. 运行Python脚本。你可以在脚本的主程序部分创建`ArbitrageBot`类的实例时，通过修改`initial_funds`参数来自定义初始资金。

## 注意事项
本项目仅用于教育和测试目的。加密货币交易存在重大风险，实际交易应谨慎进行，并遵守相关法律法规。 
